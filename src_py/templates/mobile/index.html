{% extends 'mobile/layout.html' %}
{% block title %}ä»ªè¡¨ç›˜{% endblock %}
{% block page_title %}ä»ªè¡¨ç›˜{% endblock %}

{% block content %}
<div class="header-block">
    <p class="label">æœ¬æœˆå‡€ç»“ä½™</p>
    <p class="amount-hero">Â¥{{ '%.2f'|format(monthly_savings) }}</p>
    <div class="sub-stats">
        <div>
            <span class="label">æ€»æ”¶å…¥</span>
            <strong class="income">+ Â¥{{ '%.2f'|format(monthly_income_total) }}</strong>
        </div>
        <div>
            <span class="label">æ€»æ”¯å‡º</span>
            <strong class="expense">- Â¥{{ '%.2f'|format(monthly_expense_total) }}</strong>
        </div>
    </div>
</div>

<div class="actions-grid">
    <a href="{{ url_for('add_form') }}" class="action-card primary">
        <span class="icon">+</span>
        <span class="title">è®°ä¸€ç¬”</span>
        <span class="subtitle">è®°å½•ä½ çš„æ¯ä»½æ”¶æ”¯</span>
    </a>
    <a href="{{ url_for('records') }}" class="action-card">
        <span class="icon">ğŸ“‚</span>
        <span class="title">æŸ¥çœ‹æµæ°´</span>
        <span class="subtitle">å›é¡¾å†å²è´¦å•</span>
    </a>
</div>

<div class="content-card">
    <div class="card-header">
        <h3>é¢„ç®—æ¦‚è§ˆ</h3>
        <a href="{{ url_for('settings') }}">ç®¡ç†</a>
    </div>
    {% if total_budget > 0 %}
        <div class="budget-list">
            <div class="budget-item">
                <div class="progress-info">
                    <span>æ€»é¢„ç®—</span>
                    <span>{{ '%.0f'|format(overall_budget_progress) }}%</span>
                </div>
                <div class="progress-bar-container"><div class="progress-bar" style="width:{{ overall_budget_progress }}%;"></div></div>
            </div>
            {% for category, data in budget_progress.items() %}
            <div class="budget-item">
                <div class="progress-info">
                    <span>{{ category }}</span>
                    <span class="amount {% if data.overspent %}overspent{% endif %}">Â¥{{ '%.0f'|format(data.spent) }} / {{ '%.0f'|format(data.budget) }}</span>
                </div>
                <div class="progress-bar-container small"><div class="progress-bar {% if data.overspent %}overspent-bar{% endif %}" style="width:{{ data.progress }}%;"></div></div>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="placeholder-text">æš‚æœªè®¾ç½®é¢„ç®—ï¼Œ<a href="{{ url_for('settings') }}">ç«‹å³å‰å¾€è®¾ç½®</a>ã€‚</p>
    {% endif %}
</div>
{% endblock %}
