{% extends 'mobile/layout.html' %}
{% block title %}设置 - 阳光记账{% endblock %}
{% block page_title %}设置中心{% endblock %}

{% block content %}
<div class="settings-group">
    <h3>月度预算设置</h3>
    <form action="{{ url_for('settings') }}" method="post" class="budget-form-mobile">
        {% for cat in categories.expense %}
        <div class="budget-setting-item">
            <label for="budget_{{ cat }}">{{ cat }}</label>
            <div class="budget-input">
                <span>¥</span>
                <input type="number" step="0.01" min="0" name="budget_{{ cat }}" value="{{ budgets[cat]|default('', true) }}" placeholder="0.00">
            </div>
        </div>
        {% endfor %}
        <button type="submit" class="btn-submit-mobile">保存预算</button>
    </form>
</div>

<div class="settings-group">
    <h3>类别管理</h3>
    <div class="category-management-mobile">
        <h4>支出类别</h4>
        <ul class="category-list-mobile">
            {% for cat in categories.expense %}
            <li>
                <span>{{ cat }}</span>
                <form action="{{ url_for('delete_category') }}" method="post" class="delete-form" data-message="确定删除支出类别 '{{ cat }}' 吗？">
                    <input type="hidden" name="type" value="expense">
                    <input type="hidden" name="category" value="{{ cat }}">
                    <button type="submit" class="btn-delete-sm">&times;</button>
                </form>
            </li>
            {% endfor %}
        </ul>
        <form action="{{ url_for('add_category') }}" method="post" class="add-category-form-mobile">
            <input type="hidden" name="type" value="expense">
            <input type="text" name="new_category" placeholder="新增支出类别" required>
            <button type="submit">+</button>
        </form>
    </div>
    <div class="category-management-mobile">
        <h4>收入类别</h4>
        <ul class="category-list-mobile">
            {% for cat in categories.income %}
            <li>
                <span>{{ cat }}</span>
                <form action="{{ url_for('delete_category') }}" method="post" class="delete-form" data-message="确定删除收入类别 '{{ cat }}' 吗？">
                    <input type="hidden" name="type" value="income">
                    <input type="hidden" name="category" value="{{ cat }}">
                    <button type="submit" class="btn-delete-sm">&times;</button>
                </form>
             </li>
            {% endfor %}
        </ul>
        <form action="{{ url_for('add_category') }}" method="post" class="add-category-form-mobile">
            <input type="hidden" name="type" value="income">
            <input type="text" name="new_category" placeholder="新增收入类别" required>
            <button type="submit">+</button>
        </form>
    </div>
</div>

<div class="settings-group export-section">
     <h3>数据导出</h3>
     <a href="{{ url_for('export_csv') }}" class="btn-secondary-mobile full-width">导出全部数据 (CSV)</a>
</div>
{% endblock %}
